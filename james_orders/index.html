<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì œì„ìŠ¤íŠ¸ë ŒìŠ¤ ì£¼ë¬¸ì„œ ì²˜ë¦¬</title>
    <meta name="description" content="ì£¼ë¬¸ ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ì£¼ì†Œ, ì „í™”ë²ˆí˜¸, íšŒì‚¬ëª… ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ì •ë¦¬í•˜ê³  ë‹¤ìš´ë¡œë“œí•˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.">
    <meta name="theme-color" content="#f8fafc" />
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2316a34a'%3E%3Cpath d='M4 2h14a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H6l-4-4V4a2 2 0 0 1 2-2zm8 11.5v-3h-3v-2h3v-3h2v3h3v2h-3v3h-2z'/%3E%3C/svg%3E">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"></script>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client"
      }
    }
    </script>
</head>
<body class="bg-slate-100 dark:bg-slate-800">
    <div id="root"></div>
    <script type="module">
        import React, { useState, useCallback } from 'react';
        import ReactDOM from 'react-dom/client';

        // --- Inlined Services (from services/fileProcessor.ts) ---
        const findKeyByKeyword = (headers, keyword) => {
            return headers.find(h => h.trim().replace(/\s+/g, '').includes(keyword));
        };

        const processOrderData = (data, headers) => {
            const originalAddressKey = findKeyByKeyword(headers, 'å»ºç‰©å');
            const prefectureKey = findKeyByKeyword(headers, 'éƒ½é“åºœçœŒ');
            const companyKey = findKeyByKeyword(headers, 'ä¼šç¤¾å');
            const recipientKey = findKeyByKeyword(headers, 'å±Šã‘å…ˆå');
            const phoneKey = findKeyByKeyword(headers, 'æ³¨æ–‡è€…é›»è©±ç•ªå·');
            const recipientPhoneKey = findKeyByKeyword(headers, 'ìˆ˜ë ¹ìíœ´ëŒ€í°ë²ˆí˜¸');

            const finalData = data.map(originalRecord => {
                const record = { ...originalRecord };

                if (originalAddressKey && prefectureKey) {
                    const fullAddress = record[originalAddressKey];
                    if (typeof fullAddress === 'string' && fullAddress.trim() !== '') {
                        const prefectureRegex = /^(æ±äº¬éƒ½|åŒ—æµ·é“|å¤§é˜ªåºœ|äº¬éƒ½åºœ|.{2,3}çœŒ)(.*)$/;
                        const match = fullAddress.match(prefectureRegex);
                        if (match && match[1]) {
                            record[prefectureKey] = match[1].trim();
                            record[originalAddressKey] = (match[2] || '').trim();
                        } else {
                            record[prefectureKey] = '';
                        }
                    } else {
                        record[prefectureKey] = '';
                    }
                }

                if (phoneKey) {
                    let finalPhone = record[phoneKey];
                    const recipientPhone = recipientPhoneKey ? record[recipientPhoneKey] : undefined;
                    const isPhoneEmpty = (phone) => {
                        if (phone === null || phone === undefined || phone === 0) return true;
                        if (typeof phone === 'string') {
                            const trimmed = phone.trim();
                            if (trimmed === '' || trimmed === '-') return true;
                            const cleanedForCheck = trimmed.replace(/^\+81-?/, '').trim();
                            return cleanedForCheck === '' || cleanedForCheck === '-' || cleanedForCheck === '--';
                        }
                        return false;
                    };
                    if (isPhoneEmpty(finalPhone)) {
                        if (recipientPhone && !isPhoneEmpty(recipientPhone)) {
                            finalPhone = recipientPhone;
                        }
                    }
                    if (finalPhone) {
                        let cleaned = String(finalPhone).replace(/^\+81-?/, '');
                        record[phoneKey] = (cleaned.trim() === '--' || cleaned.trim() === '-') ? '' : cleaned.trim();
                    } else {
                        record[phoneKey] = '';
                    }
                }

                if (companyKey && recipientKey) {
                    const companyName = record[companyKey];
                    if (typeof companyName === 'string' && companyName.trim() !== '') {
                        record[recipientKey] = companyName;
                        record[companyKey] = '';
                    }
                }
                
                if (recipientPhoneKey) {
                    delete record[recipientPhoneKey];
                }
                return record;
            });
            
            const finalHeaders = headers.filter(h => h !== recipientPhoneKey);
            return { processedData: finalData, processedHeaders: finalHeaders };
        };

        const readAndProcessFile = (file) => {
            return new Promise((resolve, reject) => {
                const handleFullFileRead = (e, isHtml) => {
                    try {
                        const data = e.target?.result;
                        let workbook;
                        if (isHtml) {
                            const parser = new DOMParser();
                            const doc = parser.parseFromString(data, 'text/html');
                            const table = doc.querySelector('table');
                            if (!table) throw new Error('HTML íŒŒì¼ì—ì„œ í…Œì´ë¸”ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                            const worksheet = XLSX.utils.table_to_sheet(table, { raw: true });
                            workbook = XLSX.utils.book_new();
                            XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');
                        } else {
                            workbook = XLSX.read(data, { type: 'array' });
                        }
                        const sheetName = workbook.SheetNames[0];
                        if (!sheetName) throw new Error('íŒŒì¼ì— ì‹œíŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.');
                        const worksheet = workbook.Sheets[sheetName];
                        const headers = (XLSX.utils.sheet_to_json(worksheet, { header: 1 })[0]) || [];
                        if (headers.length === 0) throw new Error('íŒŒì¼ì—ì„œ í—¤ë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŒŒì¼ì´ ë¹„ì–´ìˆê±°ë‚˜ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.');
                        const jsonData = XLSX.utils.sheet_to_json(worksheet);
                        resolve(processOrderData(jsonData, headers));
                    } catch (err) {
                        console.error(err);
                        if (err instanceof Error) {
                            reject('íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + err.message);
                        } else {
                            reject('íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                        }
                    }
                };

                const typeDetectionReader = new FileReader();
                typeDetectionReader.onload = (e) => {
                    if (!e.target?.result) {
                        return reject('íŒŒì¼ í˜•ì‹ì„ ê°ì§€í•˜ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                    const arr = new Uint8Array(e.target.result);
                    let firstChar = '';
                    for (let i = 0; i < arr.length; i++) {
                        const char = String.fromCharCode(arr[i]);
                        if (char.trim() !== '') {
                            firstChar = char;
                            break;
                        }
                    }
                    const isHtml = firstChar === '<';
                    const mainReader = new FileReader();
                    mainReader.onerror = () => reject('íŒŒì¼ì„ ì½ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    mainReader.onload = (event) => handleFullFileRead(event, isHtml);
                    if (isHtml) {
                        mainReader.readAsText(file, 'UTF-8');
                    } else {
                        mainReader.readAsArrayBuffer(file);
                    }
                };
                typeDetectionReader.onerror = () => reject('íŒŒì¼ í˜•ì‹ì„ ê°ì§€í•˜ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                typeDetectionReader.readAsArrayBuffer(file.slice(0, 10));
            });
        };


        // --- Inlined Components (from components/index.tsx) ---
        const ArrowPathIcon = (props) => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props }, React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0011.664 0l3.181-3.183m-4.991-2.696h-4.992v.001M21.015 4.356v4.992m0 0h-4.992m4.992 0l-3.181-3.183a8.25 8.25 0 00-11.664 0L2.985 9.348" }));
        const CheckCircleIcon = (props) => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props }, React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" }));
        const DownloadIcon = (props) => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props }, React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" }));
        const ExcelIcon = (props) => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "currentColor", ...props }, React.createElement("path", { d: "M4 2h14a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H6l-4-4V4a2 2 0 0 1 2-2zm8 11.5v-3h-3v-2h3v-3h2v3h3v2h-3v3h-2zm-3.5-6.5L10 8.5 8.5 7l-1.5 1.5L8.5 10l1.5-1.5L11.5 10l1.5-1.5-1.5-1.5L10 8.5 8.5 7zM6 18h12v2H6v-2z" }));
        const InformationCircleIcon = (props) => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", viewBox: "0 0 24 24", fill: "currentColor", ...props }, React.createElement("path", { fillRule: "evenodd", d: "M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 0 1 .67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 1 1-.671-1.34l.041-.022zM12 9a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z", clipRule: "evenodd" }));
        const PaperAirplaneIcon = (props) => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props }, React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" }));
        const SpinnerIcon = (props) => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", ...props }, React.createElement("circle", { className: "opacity-25", cx: "12", cy: "12", r: "10", stroke: "currentColor", strokeWidth: "4" }), React.createElement("path", { className: "opacity-75", fill: "currentColor", d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" }));
        const TrashIcon = (props) => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props }, React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.134-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.067-2.09 1.02-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" }));
        const UploadIcon = (props) => React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", strokeWidth: 1.5, stroke: "currentColor", ...props }, React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", d: "M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5" }));

        const Button = ({ isLoading = false, children, className, ...props }) => {
            const baseClasses = "inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-slate-900 transition-all duration-150";
            const colorClasses = "bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600";
            const disabledClasses = "disabled:bg-slate-400 disabled:dark:bg-slate-600 disabled:cursor-not-allowed";
            return React.createElement("button", { type: "button", className: `${baseClasses} ${colorClasses} ${disabledClasses} ${className}`, disabled: isLoading || props.disabled, ...props },
                isLoading && React.createElement(SpinnerIcon, { className: "animate-spin -ml-1 mr-3 h-5 w-5 text-white" }),
                children
            );
        };
        
        const DataTablePreview = ({ data, headers }) => {
            if (!data || data.length === 0) {
                return React.createElement("p", { className: "pl-14 text-slate-500" }, "í‘œì‹œí•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
            }
            const displayHeaders = headers && headers.length > 0 ? headers : Object.keys(data[0] || {});
            const previewData = data.slice(0, 10);
            return React.createElement("div", { className: "pl-14" },
                React.createElement("div", { className: "overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50" },
                    React.createElement("table", { className: "min-w-full divide-y divide-slate-200 dark:divide-slate-700" },
                        React.createElement("thead", { className: "bg-slate-100 dark:bg-slate-800" },
                            React.createElement("tr", null,
                                displayHeaders.map((header) => React.createElement("th", { key: header, scope: "col", className: "px-6 py-3 text-left text-sm font-medium text-slate-500 dark:text-slate-300 uppercase tracking-wider whitespace-nowrap" }, header))
                            )
                        ),
                        React.createElement("tbody", { className: "bg-white dark:bg-slate-900 divide-y divide-slate-200 dark:divide-slate-700" },
                            previewData.map((row, rowIndex) =>
                                React.createElement("tr", { key: rowIndex, className: "hover:bg-slate-50 dark:hover:bg-slate-800/70" },
                                    displayHeaders.map((header, colIndex) =>
                                        React.createElement("td", { key: `${rowIndex}-${colIndex}`, className: "px-6 py-4 whitespace-nowrap text-base text-slate-700 dark:text-slate-300" }, String(row[header] ?? ''))
                                    )
                                )
                            )
                        )
                    )
                ),
                data.length > 10 && React.createElement("p", { className: "text-right text-base text-slate-500 mt-2 pr-2" }, `... and ${data.length - 10} more rows.`)
            );
        };

        const FileUpload = ({ onFileSelect, file }) => {
            const [isDragging, setIsDragging] = useState(false);
            const handleDragEnter = (e) => { e.preventDefault(); e.stopPropagation(); setIsDragging(true); };
            const handleDragLeave = (e) => { e.preventDefault(); e.stopPropagation(); setIsDragging(false); };
            const handleDragOver = (e) => { e.preventDefault(); e.stopPropagation(); };
            const handleDrop = (e) => {
                e.preventDefault(); e.stopPropagation(); setIsDragging(false);
                if (e.dataTransfer.files && e.dataTransfer.files.length > 0) onFileSelect(e.dataTransfer.files[0]);
            };
            const handleFileChange = (e) => { if (e.target.files && e.target.files.length > 0) onFileSelect(e.target.files[0]); };
            const handleRemoveFile = () => { onFileSelect(null); };

            const baseClasses = "relative block w-full border-2 border-dashed rounded-lg p-8 text-center transition-colors duration-200 ease-in-out cursor-pointer";
            const draggingClasses = "border-blue-500 bg-blue-50 dark:bg-blue-900/30";
            const defaultClasses = "border-slate-300 dark:border-slate-600 hover:border-blue-400 dark:hover:border-blue-500";
            
            if (file) {
                return React.createElement("div", { className: "pl-14" },
                    React.createElement("div", { className: "flex items-center justify-between p-4 bg-slate-100 dark:bg-slate-800 rounded-lg" },
                        React.createElement("div", { className: "flex items-center space-x-3" },
                            React.createElement(ExcelIcon, { className: "w-8 h-8 text-green-600 dark:text-green-500" }),
                            React.createElement("span", { className: "font-medium text-slate-700 dark:text-slate-300" }, file.name)
                        ),
                        React.createElement("button", { onClick: handleRemoveFile, className: "p-2 rounded-full text-slate-500 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors" },
                            React.createElement(TrashIcon, { className: "w-5 h-5" })
                        )
                    )
                );
            }
            return React.createElement("div", { className: `${baseClasses} ${isDragging ? draggingClasses : defaultClasses}`, onDragEnter: handleDragEnter, onDragLeave: handleDragLeave, onDragOver: handleDragOver, onDrop: handleDrop },
                React.createElement("input", { type: "file", id: "file-upload", className: "absolute inset-0 w-full h-full opacity-0 cursor-pointer", onChange: handleFileChange, accept: ".xlsx, .xls, .html, .htm" }),
                React.createElement("div", { className: "flex flex-col items-center justify-center space-y-3" },
                    React.createElement(UploadIcon, { className: "w-12 h-12 text-slate-400 dark:text-slate-500" }),
                    React.createElement("p", { className: "text-slate-600 dark:text-slate-400" },
                        React.createElement("span", { className: "font-semibold text-blue-600 dark:text-blue-400" }, "íŒŒì¼ ì„ íƒ"), " ë˜ëŠ” ë“œë˜ê·¸ ì•¤ ë“œë¡­"
                    ),
                    React.createElement("p", { className: "text-xs text-slate-500 dark:text-slate-500" }, "XLSX, XLS, ë˜ëŠ” HTML íŒŒì¼")
                )
            );
        };


        // --- Inlined Main App Component (from App.tsx) ---
        const getTargetDateForFilename = () => {
            const now = new Date();
            const targetDate = new Date(now);
            const day = now.getDay();
            const hour = now.getHours();
            const minute = now.getMinutes();
            const isWeekday = day >= 1 && day <= 5;
            const isAfternoonOrLater = hour > 12 || (hour === 12 && minute > 0);
            if (isWeekday && isAfternoonOrLater) {
                if (day === 5) {
                    targetDate.setDate(now.getDate() + 3);
                } else {
                    targetDate.setDate(now.getDate() + 1);
                }
            } else if (day === 6) {
                targetDate.setDate(now.getDate() + 2);
            } else if (day === 0) {
                targetDate.setDate(now.getDate() + 1);
            }
            return targetDate;
        };

        const getFileName = () => {
            const targetDate = getTargetDateForFilename();
            const year = targetDate.getFullYear();
            const month = String(targetDate.getMonth() + 1).padStart(2, '0');
            const date = String(targetDate.getDate()).padStart(2, '0');
            return `ìŠ¤ìœ—ì»´í¼ë‹ˆ_ë°œì†¡ë¦¬ìŠ¤íŠ¸_${year}${month}${date}.xlsx`;
        };

        function App() {
            const [originalFile, setOriginalFile] = useState(null);
            const [processedData, setProcessedData] = useState(null);
            const [processedHeaders, setProcessedHeaders] = useState([]);
            const [isProcessing, setIsProcessing] = useState(false);
            const [error, setError] = useState(null);

            const resetStateForNewFile = () => {
                setProcessedData(null);
                setError(null);
                setProcessedHeaders([]);
            };

            const handleFileSelect = (file) => {
                setOriginalFile(file);
                resetStateForNewFile();
            };

            const handleProcessFile = useCallback(async () => {
                if (!originalFile) return;
                setIsProcessing(true);
                resetStateForNewFile();
                try {
                    const { processedData: resultData, processedHeaders: resultHeaders } = await readAndProcessFile(originalFile);
                    setProcessedData(resultData);
                    setProcessedHeaders(resultHeaders);
                } catch (err) {
                    setError(String(err));
                } finally {
                    setIsProcessing(false);
                }
            }, [originalFile]);

            const handleDownload = useCallback(() => {
                if (!processedData || processedHeaders.length === 0) return;
                try {
                    const newWorksheet = XLSX.utils.json_to_sheet(processedData, { header: processedHeaders });
                    const newWorkbook = XLSX.utils.book_new();
                    XLSX.utils.book_append_sheet(newWorkbook, newWorksheet, 'Processed Orders');
                    const excelBuffer = XLSX.write(newWorkbook, { bookType: 'xlsx', type: 'array' });
                    const dataBlob = new Blob([excelBuffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8' });
                    saveAs(dataBlob, getFileName());
                } catch (err) {
                    console.error(err);
                    setError('ë‹¤ìš´ë¡œë“œ íŒŒì¼ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            }, [processedData, processedHeaders]);

            const handleSendNaverMail = useCallback(() => {
                if (!processedData || processedHeaders.length === 0) {
                    setError('ì²˜ë¦¬ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                const targetDate = getTargetDateForFilename();
                const year = targetDate.getFullYear();
                const month = String(targetDate.getMonth() + 1).padStart(2, '0');
                const date = String(targetDate.getDate()).padStart(2, '0');
                const formattedDate = `${year}-${month}-${date}`;
                const subject = `[ìŠ¤ìœ—ì»´í¼ë‹ˆ ë°œì†¡ë¦¬ìŠ¤íŠ¸] ${formattedDate}`;
                const message = `ì•ˆë…•í•˜ì„¸ìš”.\n\nìŠ¤ìœ—ì»´í¼ë‹ˆ ë°œì†¡ë¦¬ìŠ¤íŠ¸ ì…ë‹ˆë‹¤.\nì²¨ë¶€ëœ ì—‘ì…€ íŒŒì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.\n\nì˜ ë¶€íƒë“œë¦½ë‹ˆë‹¤.`;
                const fullContent = `ì œëª©: ${subject}\n\n${message}`;

                navigator.clipboard.writeText(fullContent).then(() => {
                    window.open('https://mail.naver.com/write/', '_blank');
                    alert(`ğŸ“‹ ë©”ì¼ ë‚´ìš©ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nğŸ“§ ë„¤ì´ë²„ ë©”ì¼ì´ ìƒˆ íƒ­ì—ì„œ ì—´ë ¸ìŠµë‹ˆë‹¤.\n\nğŸ”„ ì‚¬ìš©ë²•:\n1. ë°›ëŠ” ì‚¬ëŒ ì…ë ¥\n2. Ctrl+Vë¡œ ì œëª©ê³¼ ë‚´ìš© ë¶™ì—¬ë„£ê¸°\n3. ì²˜ë¦¬ëœ ì—‘ì…€ íŒŒì¼ ì²¨ë¶€\n4. ë°œì†¡ ì™„ë£Œ!`);
                }).catch(() => {
                    window.open('https://mail.naver.com/write/', '_blank');
                    setError('í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë„¤ì´ë²„ ë©”ì¼ì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.');
                    console.log('ë©”ì¼ ë‚´ìš©:', fullContent);
                });
            }, [processedData, processedHeaders]);

            return React.createElement("div", { className: "min-h-screen flex flex-col items-center justify-center p-4 sm:p-6 bg-slate-100 dark:bg-slate-800 text-slate-800 dark:text-slate-200" },
                React.createElement("div", { className: "w-full max-w-4xl mx-auto" },
                    React.createElement("header", { className: "text-center mb-8" },
                        React.createElement("h1", { className: "text-3xl sm:text-4xl font-bold text-slate-900 dark:text-white" }, "ì œì„ìŠ¤íŠ¸ë ŒìŠ¤ ì£¼ë¬¸ì„œ ì²˜ë¦¬"),
                        React.createElement("p", { className: "mt-2 text-lg text-slate-600 dark:text-slate-400" }, "ì£¼ë¬¸ì„œ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ì •ë¦¬í•˜ê³  ë°œì†¡í•˜ì„¸ìš”.")
                    ),
                    React.createElement("main", { className: "bg-white dark:bg-slate-900/70 rounded-xl shadow-lg p-6 sm:p-8 space-y-6 backdrop-blur-sm" },
                        React.createElement("div", { className: "flex items-start space-x-4" },
                            React.createElement("div", { className: "flex-shrink-0 flex items-center justify-center h-10 w-10 rounded-full bg-blue-500 text-white font-bold text-lg" }, "1"),
                            React.createElement("div", null,
                                React.createElement("h2", { className: "text-xl font-semibold text-slate-800 dark:text-white" }, "ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ"),
                                React.createElement("p", { className: "text-slate-500 dark:text-slate-400 mt-1" }, "ì²˜ë¦¬í•  ì£¼ë¬¸ì„œ ì—‘ì…€ íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ëŒì–´ë‹¤ ë†“ìœ¼ì„¸ìš”.")
                            )
                        ),
                        React.createElement(FileUpload, { onFileSelect: handleFileSelect, file: originalFile }),
                        React.createElement("div", { className: "flex items-start space-x-4" },
                            React.createElement("div", { className: "flex-shrink-0 flex items-center justify-center h-10 w-10 rounded-full bg-blue-500 text-white font-bold text-lg" }, "2"),
                            React.createElement("div", null,
                                React.createElement("h2", { className: "text-xl font-semibold text-slate-800 dark:text-white" }, "ë°ì´í„° ì²˜ë¦¬ ë° ë¯¸ë¦¬ë³´ê¸°"),
                                React.createElement("p", { className: "text-slate-500 dark:text-slate-400 mt-1" }, "íŒŒì¼ ì—…ë¡œë“œ í›„, ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë°ì´í„° ì •ë¦¬ë¥¼ ì‹œì‘í•˜ê³  ê²°ê³¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.")
                            )
                        ),
                        React.createElement("div", { className: "pl-14" },
                            React.createElement(Button, { onClick: handleProcessFile, disabled: !originalFile || isProcessing, isLoading: isProcessing, className: "w-full sm:w-auto" },
                                React.createElement(ArrowPathIcon, { className: "w-5 h-5 mr-2" }),
                                isProcessing ? 'ì²˜ë¦¬ ì¤‘...' : 'íŒŒì¼ ì²˜ë¦¬ ë° ë¯¸ë¦¬ë³´ê¸°'
                            )
                        ),
                        error && React.createElement("div", { className: "pl-14 text-red-500 bg-red-100 dark:bg-red-900/30 p-3 rounded-lg" }, error),
                        processedData && React.createElement(React.Fragment, null,
                            React.createElement(DataTablePreview, { data: processedData, headers: processedHeaders }),
                            React.createElement("div", { className: "flex items-start space-x-4 pt-6" },
                                React.createElement("div", { className: "flex-shrink-0 flex items-center justify-center h-10 w-10 rounded-full bg-green-500 text-white" }, 
                                    React.createElement(CheckCircleIcon, { className: "w-6 h-6" })
                                ),
                                React.createElement("div", null,
                                    React.createElement("h2", { className: "text-xl font-semibold text-slate-800 dark:text-white" }, "3. ê²°ê³¼ ì €ì¥ ë° ë°œì†¡"),
                                    React.createElement("p", { className: "text-slate-500 dark:text-slate-400 mt-1" }, "ì²˜ë¦¬ëœ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ê³ , ë„¤ì´ë²„ ë©”ì¼ë¡œ ë°œì†¡í•©ë‹ˆë‹¤.")
                                )
                            ),
                            React.createElement("div", { className: "pl-14 flex flex-wrap gap-4" },
                                React.createElement(Button, { onClick: handleDownload, className: "bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 focus:ring-green-500" },
                                    React.createElement(DownloadIcon, { className: "w-5 h-5 mr-2" }),
                                    "ì—‘ì…€ íŒŒì¼ ë‹¤ìš´ë¡œë“œ"
                                ),
                                React.createElement(Button, { onClick: handleSendNaverMail, className: "bg-sky-600 hover:bg-sky-700 dark:bg-sky-500 dark:hover:bg-sky-600 focus:ring-sky-500" },
                                    React.createElement(PaperAirplaneIcon, { className: "w-5 h-5 mr-2" }),
                                    "ë©”ì¼ ë°œì†¡í•˜ê¸°"
                                )
                            ),
                            React.createElement("div", { className: "pl-14 pt-4" },
                                React.createElement("div", { className: "flex items-start p-3 bg-sky-50 dark:bg-sky-900/30 rounded-lg border border-sky-200 dark:border-sky-800" },
                                    React.createElement("div", { className: "flex-shrink-0" },
                                        React.createElement(InformationCircleIcon, { className: "w-5 h-5 text-sky-600 dark:text-sky-400", "aria-hidden": "true" })
                                    ),
                                    React.createElement("div", { className: "ml-3" },
                                        React.createElement("p", { className: "text-sm text-sky-700 dark:text-sky-200" },
                                            React.createElement("strong", null, "ì‚¬ìš©ë²• ì•ˆë‚´:"), " 'ë©”ì¼ ë°œì†¡í•˜ê¸°' ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì œëª©ê³¼ ë³¸ë¬¸ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤. ìƒˆë¡œ ì—´ë¦° ë„¤ì´ë²„ ë©”ì¼ ì°½ì— ë¶™ì—¬ë„£ê¸°(Ctrl+V)í•˜ì—¬ ì‚¬ìš©í•˜ì„¸ìš”."
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            );
        }

        // --- App Mount ---
        const rootElement = document.getElementById('root');
        if (rootElement) {
            const root = ReactDOM.createRoot(rootElement);
            root.render(React.createElement(React.StrictMode, null, React.createElement(App)));
        } else {
            console.error("Root element not found");
        }
    </script>
</body>
</html>
